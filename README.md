# 今日の振り返り (Habitapp)

Firebase Firestore に日々の学習や習慣の記録を保存し、履歴を振り返れるシンプルな Web アプリです。ビルド手順は不要で、静的ファイルをそのままホスティングすれば動作します。

## セットアップ

1. Firebase コンソールで Firestore を有効化し、Web アプリを作成します。
2. 発行された `firebaseConfig` を `main.js` 冒頭の定数に貼り付けます。
3. `index.html` をブラウザで開くか、`python -m http.server` などでローカルサーバーを立ち上げてアクセスします。

> **メモ:** アプリ起動時に Firebase 設定を自動検証し、結果をブラウザのコンソールと `window.__FIREBASE_CONFIG_DIAGNOSTICS__` に出力します。設定値が欠けている場合はコンソールにエラーが表示されます。

## 使い方

### 1. 習慣を追加・編集する

1. 画面上部の「習慣を編集」ボタンを押すとモーダルが開きます。
2. 既存の習慣は一覧から直接編集・保存できます。不要になった場合は「アクティブにする」のチェックを外します。
3. 新しい習慣は「新しい習慣を追加」フォームに名前・タイプ・単位を入力して「追加する」を押します。
4. 追加・更新後は習慣チェックリストが即座に更新されます。

### 2. 習慣と日記を記録する

1. 画面中央の習慣チェックリストで各項目を入力またはチェックします。
2. 日記フォームで学習時間・日記・メモを入力します。
3. 「保存」を押すと Firestore に記録され、画面右下のトーストと「保存しました」のステータスで確認できます。
4. 過去の日付は日付ピッカー、前日/今日/次の日ボタンで切り替えられます。

### 3. CSV でエクスポートする

1. 「エクスポート」ボタンを押すと期間指定モーダルが開きます。
2. 開始日と終了日を入力して「CSV をダウンロード」を押すと、選択した期間の記録が `habitapp_YYYY-MM-DD_YYYY-MM-DD.csv` 形式でダウンロードされます。
3. 各行には日付・日記・登録した全習慣の値が含まれます。真偽値の習慣は `1`/`0` で表現されます。

### 4. 履歴を可視化する

1. ヘッダーの「履歴を見る」ボタンを押して履歴モーダルを開きます。
2. 上部のプルダウンで対象の習慣を選択すると、直近 30 日間の推移がグラフとカレンダーで表示されます。
   - グラフ: 真偽値は棒グラフ、数値は折れ線グラフで描画されます。
   - カレンダー: 日付ごとに記録値や達成状況を色分け・記号で表示します。
3. データが存在しない場合はメッセージが表示されます。

## 静的ホスティングについて

- 本プロジェクトは HTML/CSS/JavaScript のみで構成されており、`npm` やビルドステップは不要です。
- 依存ライブラリは CDN から読み込んでいます。オフラインで動作させる場合は必要に応じてダウンロードしたファイルをローカル参照に置き換えてください。
- GitHub Pages などの静的ホスティングにアップロードする際は、`index.html` と同階層に `main.js` と `styles.css` を配置してください。

## Firebase 設定の確認

- `main.js` では `firebaseConfig` の必須キーが揃っているか、`authDomain` と `projectId` が整合しているかを起動時に検証します。
- 検証結果はコンソールと `window.__FIREBASE_CONFIG_DIAGNOSTICS__` に出力されます。`environment` には `localhost` アクセス時は `development`、それ以外は `production` が入ります。
- GitHub Pages など本番 URL でも `authDomain` が Firebase プロジェクトのドメイン (`*.firebaseapp.com` / `*.web.app`) と一致しているかを確認してください。

## 手動確認チェックリスト

- [ ] 保存ボタンで日々の記録を正常に保存できる
- [ ] 日付の切り替え（前日/今日/次の日・日付ピッカー）が動作する
- [ ] 習慣の追加・編集・非アクティブ化が反映される
- [ ] エクスポート機能で CSV がダウンロードできる
- [ ] 履歴モーダルでグラフとカレンダーが表示される
- [ ] Firebase 設定診断 (`window.__FIREBASE_CONFIG_DIAGNOSTICS__`) にエラーがない

## 依存 CDN

- [Chart.js 4.4.3](https://www.chartjs.org/)（グラフ描画用）
- [Firebase 10.13.0](https://firebase.google.com/docs/web/alt-setup)（`firebase-app` / `firebase-firestore` モジュール）

必要に応じてバージョンを固定し、キャッシュ破棄時の挙動を確認してください。
